{"version":3,"file":"index.es.js","sources":["../src/index.js"],"sourcesContent":["import PropTypes from 'prop-types'\nimport React, { useState, useEffect } from 'react'\n\nconst CypherText = ({ textList, delay, ...props }) => {\n  const [CypherText, setCypherText] = useState('')\n  const placeholderChars = '________-_\\\\/[]{}â€”=+*^?#!<>'\n\n  let textIndex = 0\n  let queue = []\n\n  let frameRequest\n  let frame\n  let resolvePromise\n\n  const setText = newText => {\n    const oldText =\n      textList[textIndex === 0 ? textList.length - 1 : textIndex - 1]\n    const length = Math.max(oldText.length, newText.length)\n    const promise = new Promise(resolve => (resolvePromise = resolve))\n    queue = []\n    for (let i = 0; i < length; i++) {\n      const from = oldText[i] || ''\n      const to = newText[i] || ''\n      const start = Math.floor(Math.random() * 40)\n      const end = start + Math.floor(Math.random() * 40)\n      queue.push({ from, to, start, end })\n    }\n    window.cancelAnimationFrame(frameRequest)\n    frame = 0\n    update()\n    return promise\n  }\n\n  const update = () => {\n    let complete = 0\n\n    const output = queue.map((item, i) => {\n      let { from, to, start, end, char } = item\n      if (frame >= end) {\n        complete++\n        return <React.Fragment key={i}>{to}</React.Fragment>\n      } else if (frame >= start) {\n        if (!char || Math.random() < 0.28) {\n          char = randomChar(placeholderChars)\n          item.char = char\n        }\n        return (\n          <span key={i} style={{ color: '#909090' }}>\n            {char}\n          </span>\n        )\n      } else {\n        return <React.Fragment key={i}>{from}</React.Fragment>\n      }\n    })\n\n    setCypherText(output)\n\n    if (complete === queue.length) {\n      resolvePromise()\n    } else {\n      frameRequest = window.requestAnimationFrame(update)\n      frame++\n    }\n  }\n\n  const randomChar = string => string[Math.floor(Math.random() * string.length)]\n\n  const next = () => {\n    setText(textList[textIndex]).then(() => {\n      setTimeout(next, delay)\n    })\n\n    textIndex = (textIndex + 1) % textList.length\n  }\n\n  useEffect(() => {\n    next()\n    return () => {\n      clearTimeout(next)\n      window.cancelAnimationFrame(frameRequest)\n    }\n  }, [])\n\n  return <div {...props}>{CypherText}</div>\n}\n\nCypherText.propTypes = {\n  textList: PropTypes.array.isRequired,\n  delay: PropTypes.number,\n  randomOrder: PropTypes.bool\n}\n\nCypherText.defaultProps = {\n  delay: 800\n}\n\nexport default CypherText\n"],"names":["CypherText","textList","delay","props","useState","setCypherText","placeholderChars","textIndex","queue","frameRequest","frame","resolvePromise","setText","oldText","length","Math","max","newText","promise","Promise","resolve","i","from","to","start","floor","random","end","push","cancelAnimationFrame","update","complete","output","map","item","char","randomChar","color","window","requestAnimationFrame","string","next","then","propTypes","PropTypes","array","isRequired","number","bool","defaultProps"],"mappings":"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"}